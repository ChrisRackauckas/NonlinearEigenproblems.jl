<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Deflation · NEP-PACK</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>NEP-PACK</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../methods/">NEP-Solvers</a></li><li><a class="toctext" href="../types/">Types &amp; Data structures</a></li><li><a class="toctext" href="../compute_functions/">Compute functions</a></li><li><a class="toctext" href="../linsolvers/">Linear solvers</a></li><li><a class="toctext" href="../innersolvers/">Projection</a></li><li><a class="toctext" href="../errmeasure/">Measuring the error</a></li><li><a class="toctext" href="../logger/">Logger</a></li><li><a class="toctext" href="../transformations/">Transformations</a></li><li class="current"><a class="toctext" href>Deflation</a><ul class="internal"></ul></li><li><a class="toctext" href="../gallery/">Gallery</a></li></ul></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../movebc_tutorial/">Tutorial 1 (ABC)</a></li><li><a class="toctext" href="../tutorial_contour/">Tutorial 2 (Contour)</a></li><li><a class="toctext" href="../bemtutorial/">Tutorial 3 (BEM)</a></li><li><a class="toctext" href="../deflate_tutorial/">Tutorial 4 (Deflation)</a></li><li><a class="toctext" href="../tutorial_call_python/">Tutorial 5 (Python)</a></li><li><a class="toctext" href="../tutorial_matlab1/">Tutorial 6 (MATLAB)</a></li><li><a class="toctext" href="../tutorial_fortran1/">Tutorial 7 (FORTRAN)</a></li><li><a class="toctext" href="../tutorial_nano1/">Tutorial 8 (gmsh + nanophotonics)</a></li><li><a class="toctext" href="../tutorial_newmethod/">Tutorial 9 (New solver)</a></li><li><a class="toctext" href="../tutorial_linsolve/">Tutorial 10 (Linear solvers)</a></li><li><a class="toctext" href="../hydrotutorial/">Tutorial 11 (Orr-Somerfeld)</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Deflation</a></li></ul><a class="edit-page" href="https://github.com/nep-pack/NonlinearEigenproblems.jl/blob/master/docs/src/deflation.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Deflation</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Deflation-1" href="#Deflation-1">Deflation</a></h1><p>Due to structure of the representation of NEPs in NEP-PACK it is possible to do deflation, by transformation of the NEP-object. The deflation is based on theory provided in Effenbergers thesis and the main function consists of <a href="#NonlinearEigenproblems.NEPTypes.deflate_eigpair"><code>deflate_eigpair</code></a>. See also <a href="../deflate_tutorial/">the tutorial on deflation</a>.</p><p>** TODO: This description needs to be extended (maybe move theory from tutorial) **</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NonlinearEigenproblems.NEPTypes.deflate_eigpair" href="#NonlinearEigenproblems.NEPTypes.deflate_eigpair"><code>NonlinearEigenproblems.NEPTypes.deflate_eigpair</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">dnep=deflate_eigpair(orgnep::NEP,λ,v,[mode=:Auto])</code></pre><p>This function creates a deflated NEP based on <span>$(λ,v)$</span>, which are assumed to an eigenpair of <code>nep</code>. Effectively, the function will return <code>dnep::NEP</code> which has the same solutions as orgnep, except those corresponding to <span>$(λ,v)$</span>. Deflation is typically used to avoid reconvergence.</p><p>If <code>orgnep</code> is a <code>DeflatedNEP</code>, the <code>orgnep</code> the deflation in <code>orgnep</code> will be updated.</p><p>The <code>mode</code> kwarg can be <code>:Auto</code>, <code>:Generic</code>, <code>:SPMF</code>, <code>:MM</code>. This specifies how the deflated NEP should be represented. Which mode is the most efficient depends on many problem properties. If the original NEP is an <code>AbstractSPMF</code> with only a few terms, <code>mode=:SPMF</code> may be efficient. The SPMF-mode is based on a diagonalization of the deflated invariant pair and is not necessarily robust when you deflate eigenvalues near to each other. When <code>mode=:MM</code> is used, all compute functions are implemented via calls to the <code>compute_MM</code>. This can work well for small dense problems. The <code>:Generic</code> is based on an explicit derivation of the problem (via binomial expansion) which can be efficient if low order derivates are needed. If <code>:Auto</code> is selected, NEP-PACK tries to determine which one is the most efficient based on the <code>orgnep</code>.</p><p><strong>Example:</strong></p><pre><code class="language-julia-repl">julia&gt; nep=nep_gallery(&quot;dep0&quot;);
julia&gt; (λ,v)=newton(nep);
julia&gt; n=size(nep,1);
julia&gt; dnep=deflate_eigpair(nep,λ,v)
julia&gt; (λ2,v2)=augnewton(dnep);  # this converges to different eigval
julia&gt; using LinearAlgebra;
julia&gt; minimum(svdvals(compute_Mder(nep,λ2)))
9.323003321058995e-17</code></pre><p>The function <a href="#NonlinearEigenproblems.NEPTypes.get_deflated_eigpairs"><code>get_deflated_eigpairs()</code></a> extracts the eigenpairs that have been deflated. The returned pairs are eigenpairs of the original NEP:</p><pre><code class="language-none">julia&gt; dnep=deflate_eigpair(dnep,λ2,v2)
julia&gt; (D,V)=get_deflated_eigpairs(dnep)
julia&gt; norm(compute_Mlincomb(nep,D[1],V[:,1]))
6.164690797405912e-16
julia&gt; norm(compute_Mlincomb(nep,D[2],V[:,2]))
5.20740757162067e-16</code></pre><p><strong>References</strong></p><ul><li>C. Effenberger, Robust solution methods for nonlinear eigenvalue problems, PhD thesis, 2013, EPF Lausanne</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NonlinearEigenproblems.NEPTypes.get_deflated_eigpairs" href="#NonlinearEigenproblems.NEPTypes.get_deflated_eigpairs"><code>NonlinearEigenproblems.NEPTypes.get_deflated_eigpairs</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">(D,V)=get_deflated_eigpairs(dnep::DeflatedNEP [λ,v])</code></pre><p>Returns a vector of eigenvalues <code>D</code> and a matrix with corresponding eigenvectors <code>V</code>. The eigenpairs correspond to the original problem, underlying the <code>DeflatedNEP</code>. The optional parameters <code>λ,v</code> allows the inclusion of an additional eigpair. Essentially, the optional parameters are the expanding the deflation and the running <code>get_deflated_eigpairs</code>  with kwarg, i.e.,</p><pre><code class="language-julia">(D,V)=get_deflated_eigpairs(deflate_eigpair(dnep,λ,v))`</code></pre><p>See example in <a href="#NonlinearEigenproblems.NEPTypes.deflate_eigpair"><code>deflate_eigpair</code></a>.</p></div></div></section><footer><hr/><a class="previous" href="../transformations/"><span class="direction">Previous</span><span class="title">Transformations</span></a><a class="next" href="../gallery/"><span class="direction">Next</span><span class="title">Gallery</span></a></footer></article></body></html>
